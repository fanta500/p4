{
  "operations": [
    {
      "$derive": {
        "AgeDiff": "abs(FatherAge - MotherAge)"
      }
    },
    {
      "$match": {
        "AgeDiff": [0, 10]
      }
    },
    {
      "$aggregate": {
        "$group": "AgeDiff",
        "$collect": {
          "Babies": {"$count": "*"},
          "BabyAvgWeight": {"$avg": "BabyWeight"}
        }
      }
    },
    {
      "$visualize": {
        "mark": "bar",
        "height": "Babies",
        "x": "AgeDiff",
        "color": "BabyAvgWeight"
      }
    }
  ]
}
